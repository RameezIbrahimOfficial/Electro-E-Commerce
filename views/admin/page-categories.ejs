<%- include('../partials/admin-header')%>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
<script>
    $(document).ready(function () {
        new DataTable('#example');

    })
</script>
        <section class="content-main">
            <div class="content-header">
                <div>
                    <h2 class="content-title card-title">Categories </h2>
                    <p>Add or Block a category</p>
                </div>
                <div>
                    <input type="text" placeholder="Search Categories" class="form-control bg-white">
                </div>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="alert-danger" id="error-message"></div>
                        <div class="col-md-3">
                            <form method="post" action="/admin/admin_panel/ceate_category" id="categoryForm">
                                <!-- <div class="mb-4">
                                    <label for="product_name" class="form-label">#ID</label>
                                    <input type="number" placeholder="Type here" class="form-control" id="categoryID" name="categoryId"/>
                                </div> -->
                                <div class="mb-4">
                                    <label for="categoryID" class="form-label">#ID</label>
                                    <input type="text" placeholder="Type here" class="form-control" id="categoryId" name="categoryID"/>
                                </div>
                                <div class="mb-4">
                                    <label for="categoryName" class="form-label">Name</label>
                                    <input type="text" placeholder="Type here" class="form-control" id="categoryName" name="categoryName"/>
                                </div>
                                <div class="mb-4">
                                    <label class="form-label">Status</label>
                                    <select class="form-select" name="status">
                                        <option value="Listed"> List </option>
                                        <option value="Unlisted"> Unlist</option>
                                    </select>
                                </div>
                                <div class="d-grid">
                                    <button class="btn btn-primary" type="submit">Create category</button>
                                </div>
                            </form>
                        </div>
                        <div class="col-md-9">
                            <div class="table-responsive">
                                <table class="table table-hover" id="example">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Name</th>
                                            <th>Status</th>
                                            <th>Edit</th>
                                            <th>Delete</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <%if(categories){%>

                                            <%for(i=0;i<categories.length;i++){%>
                                                <tr>
                                                    <td><%=categories[i].categoryId%></td>
                                                    <td><b><%=categories[i].categoryName%></b></td>
                                                    <td>
                                                        <%if(categories[i].isListed=="Listed"){%>
                                                            <span class="badge rounded-pill alert-success">Listed</span>
                                                        <%}else{%>
                                                            <span class="badge rounded-pill alert-danger">Unlisted</span>
                                                        <%}%>
                                                    </td>

                                                    <td><a href="/admin/admin_panel/edit_category?id=<%=categories[i]._id%>" class="btn btn-lg font-sm rounded btn-brand">
                                                        <i class="material-icons md-edit"></i> Edit
                                                    </a></td>
                                                    <td>
                                                        <%if(categories[i].isListed=="Listed"){%>
                                                            <a href="/admin/admin_panel/block_category?id=<%=categories[i]._id%>" class="btn btn-lg font-sm btn-danger rounded"> Block</a>
                                                        <%}else{%>
                                                            <a href="/admin/admin_panel/unblock_category?id=<%=categories[i]._id%>" class="btn btn-lg font-sm btn-success rounded"> Unblock</a>
                                                        <%}%>
                                                    </td>
        
                                                </tr>
                                            <%}%>
                
                                        <%}else{%>
                                            <tr>
                                                <td>
                                                    <h4>No Category Found</h4>
                                                </td>
                                            </tr>
                                        <%}%>
                                    </tbody>
                                </table>
                            </div>
                        </div> <!-- .col// -->
                    </div> <!-- .row // -->
                </div> <!-- card body .// -->
            </div> <!-- card .// -->
        </section> <!-- content-main end// -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        function validateCategoryForm() {
            // Reset any previous error messages
            $('#error-message').html('');

            // Get form input values
            var categoryName = $('#categoryName').val();
            var status = $('#status').val();
            var categoryId = $('#categoryId').val();
            
            // Validation rules

            if (categoryId.trim() === '') {
                $('#error-message').html('Category ID is required.');
                return false;
            }

            if (categoryName.trim() === '') {
                $('#error-message').html('Category Name is required.');
                return false;
            }

            if (status === '') {
                $('#error-message').html('Status is required.');
                return false;
            }

            // Additional validation rules

            // Check if Category Name contains only letters and spaces
            var namePattern = /^[A-Za-z\s]+$/;
            if (!namePattern.test(categoryName)) {
                $('#error-message').html('Category Name can only contain letters and spaces.');
                return false;
            }

            return true;
        }

        // Form submit event
        $('#categoryForm').submit(function (e) {
            if (!validateCategoryForm()) {
                e.preventDefault(); // Prevent form submission if validation fails
            }
        });
    });
</script>
        <%- include('../partials/admin-footer')%>